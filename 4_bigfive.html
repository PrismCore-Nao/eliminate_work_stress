<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ãƒ“ãƒƒã‚°ãƒ•ã‚¡ã‚¤ãƒ–è¨ºæ–­</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Helvetica Neue', Arial, 'Hiragino Kaku Gothic ProN', 'Hiragino Sans', Meiryo, sans-serif;
            background-color: #ffffff;
            color: #000000;
            line-height: 1.8;
            padding: 20px;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: #ffffff;
        }

        h1 {
            background-color: #ffff00;
            color: #000000;
            padding: 30px 20px;
            text-align: center;
            font-size: 28px;
            font-weight: bold;
            margin-bottom: 40px;
            border: 2px solid #000000;
        }

        .instruction {
            background-color: #f9f9f9;
            border-left: 4px solid #ffff00;
            padding: 15px 20px;
            margin-bottom: 30px;
            font-size: 14px;
        }

        .question {
            margin-bottom: 40px;
            padding: 25px;
            background-color: #fafafa;
            border: 1px solid #e0e0e0;
        }

        .question-text {
            font-weight: bold;
            margin-bottom: 20px;
            font-size: 16px;
            line-height: 1.6;
        }

        .slider-container {
            padding: 10px 0;
        }

        .slider-labels {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
            font-size: 13px;
            color: #333;
        }

        .slider-labels span {
            flex: 1;
            text-align: center;
            padding: 0 5px;
        }

        .slider-labels span:first-child {
            text-align: left;
        }

        .slider-labels span:last-child {
            text-align: right;
        }

        input[type="range"] {
            -webkit-appearance: none;
            appearance: none;
            width: 100%;
            height: 8px;
            background: #d3d3d3;
            outline: none;
            border-radius: 5px;
            margin: 10px 0;
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 24px;
            height: 24px;
            background: #ffff00;
            border: 2px solid #000000;
            cursor: pointer;
            border-radius: 50%;
        }

        input[type="range"]::-moz-range-thumb {
            width: 24px;
            height: 24px;
            background: #ffff00;
            border: 2px solid #000000;
            cursor: pointer;
            border-radius: 50%;
        }

        .slider-wrapper {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .result-box {
            background-color: #fffef0;
            border: 2px solid #ffff00;
            padding: 20px;
            margin-top: 30px;
            font-size: 15px;
            display: none;
        }

        .result-box.show {
            display: block;
        }

        .result-box h3 {
            background-color: #ffff00;
            color: #000000;
            padding: 10px;
            margin: -20px -20px 15px -20px;
            font-size: 18px;
        }

        .result-item {
            margin: 15px 0;
            padding: 15px;
            background-color: #ffffff;
            border-left: 4px solid #ffff00;
        }

        .button-group {
            display: flex;
            gap: 20px;
            justify-content: center;
            margin-top: 40px;
            flex-wrap: wrap;
        }

        .submit-button, .pdf-button {
            background-color: #ffff00;
            color: #000000;
            border: 2px solid #000000;
            padding: 15px 40px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }

        .submit-button:hover, .pdf-button:hover {
            background-color: #000000;
            color: #ffff00;
        }

        .pdf-button {
            display: none;
        }

        .pdf-button.show {
            display: inline-block;
        }

        .submit-button.hide {
            display: none;
        }

        .print-title {
            display: none;
        }

        @media print {
            body * {
                visibility: hidden;
            }
            .print-title, .print-title *,
            .result-box, .result-box * {
                visibility: visible;
            }
            .print-title {
                display: block;
                position: absolute;
                left: 0;
                top: 0;
                width: 100%;
                background-color: #ffff00;
                color: #000000;
                padding: 20px;
                text-align: center;
                font-size: 24px;
                font-weight: bold;
                border: 2px solid #000000;
            }
            .result-box {
                position: absolute;
                left: 0;
                top: 80px;
                width: 100%;
            }
            .pdf-button, .submit-button, .question, .instruction, h1 {
                display: none !important;
            }
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 22px;
                padding: 20px 15px;
            }

            .question {
                padding: 20px 15px;
            }

            .slider-labels {
                font-size: 11px;
            }

            .slider-labels span {
                padding: 0 2px;
            }

            .button-group {
                flex-direction: column;
            }

            .submit-button, .pdf-button {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="print-title">PART 4ã€€ãƒ“ãƒƒã‚°ãƒ•ã‚¡ã‚¤ãƒ–è¨ºæ–­</div>

        <h1>ãƒ“ãƒƒã‚°ãƒ•ã‚¡ã‚¤ãƒ–è¨ºæ–­<br>ã‚ãªãŸã®æ€è€ƒãƒ‘ã‚¿ãƒ¼ãƒ³æ¸¬å®š</h1>

        <div class="instruction">
            ä»¥ä¸‹ã®è³ªå•ã«ã¤ã„ã¦ã€å½“ã¦ã¯ã¾ã‚‹å›ç­”ã‚’é¸ã‚“ã§ãã ã•ã„ã€‚
        </div>

        <form id="diagnosisForm">
            <div class="question">
                <div class="question-text">1. ç§ã¯ã€è©±ã™ã“ã¨ãŒå¥½ãã§ã€æˆåŠŸã«èˆˆå‘³ãŒã‚ã‚Šã€äººã¨ä¼šã†ã®ã‚’æ¥½ã—ã‚ã‚‹äººé–“ã ã€‚</div>
                <div class="slider-container">
                    <div class="slider-labels">
                        <span>ã‹ãªã‚Šå½“ã¦ã¯ã¾ã‚‹</span>
                        <span>å½“ã¦ã¯ã¾ã‚‹</span>
                        <span>ã©ã¡ã‚‰ã§ã‚‚ãªã„</span>
                        <span>å½“ã¦ã¯ã¾ã‚‰ãªã„</span>
                        <span>ã‹ãªã‚Šå½“ã¦ã¯ã¾ã‚‰ãªã„</span>
                    </div>
                    <div class="slider-wrapper">
                        <input type="range" dir="rtl" name="q1" min="0" max="4" value="2" step="1" class="slider" data-question="1">
                    </div>
                </div>
            </div>

            <div class="question">
                <div class="question-text">2. ç§ã¯ã€ã„ã¤ã‚‚èµ·ãã¦ã‚‚ã„ãªã„ã“ã¨ã‚’è€ƒãˆã¦ã€ä¸å®‰ã‚„æ°—åˆ†ã®æµ®ãæ²ˆã¿ãŒå¤šã„äººé–“ã ã€‚</div>
                <div class="slider-container">
                    <div class="slider-labels">
                        <span>ã‹ãªã‚Šå½“ã¦ã¯ã¾ã‚‹</span>
                        <span>å½“ã¦ã¯ã¾ã‚‹</span>
                        <span>ã©ã¡ã‚‰ã§ã‚‚ãªã„</span>
                        <span>å½“ã¦ã¯ã¾ã‚‰ãªã„</span>
                        <span>ã‹ãªã‚Šå½“ã¦ã¯ã¾ã‚‰ãªã„</span>
                    </div>
                    <div class="slider-wrapper">
                        <input type="range" dir="rtl" name="q2" min="0" max="4" value="2" step="1" class="slider" data-question="2">
                    </div>
                </div>
            </div>

            <div class="question">
                <div class="question-text">3. ç§ã¯ã€çŸ¥çš„ãªæ´»å‹•ãŒå¾—æ„ã§ã€å‰µé€ æ€§ãŒé«˜ãã¦å¥½å¥‡å¿ƒãŒã‚ã‚Šã€æ–°ã—ã„ã“ã¨ãŒå¥½ãã ã€‚</div>
                <div class="slider-container">
                    <div class="slider-labels">
                        <span>ã‹ãªã‚Šå½“ã¦ã¯ã¾ã‚‹</span>
                        <span>å½“ã¦ã¯ã¾ã‚‹</span>
                        <span>ã©ã¡ã‚‰ã§ã‚‚ãªã„</span>
                        <span>å½“ã¦ã¯ã¾ã‚‰ãªã„</span>
                        <span>ã‹ãªã‚Šå½“ã¦ã¯ã¾ã‚‰ãªã„</span>
                    </div>
                    <div class="slider-wrapper">
                        <input type="range" dir="rtl" name="q3" min="0" max="4" value="2" step="1" class="slider" data-question="3">
                    </div>
                </div>
            </div>

            <div class="question">
                <div class="question-text">4. ç§ã¯ã€äººã¸ã®æ€ã„ã‚„ã‚ŠãŒã‚ã‚Šã€è¦ªåˆ‡ãªè¡Œå‹•ã‚’ã¨ã‚Šã€ä»–äººã‚’å·®åˆ¥ã—ãªã„ã€‚</div>
                <div class="slider-container">
                    <div class="slider-labels">
                        <span>ã‹ãªã‚Šå½“ã¦ã¯ã¾ã‚‹</span>
                        <span>å½“ã¦ã¯ã¾ã‚‹</span>
                        <span>ã©ã¡ã‚‰ã§ã‚‚ãªã„</span>
                        <span>å½“ã¦ã¯ã¾ã‚‰ãªã„</span>
                        <span>ã‹ãªã‚Šå½“ã¦ã¯ã¾ã‚‰ãªã„</span>
                    </div>
                    <div class="slider-wrapper">
                        <input type="range" dir="rtl" name="q4" min="0" max="4" value="2" step="1" class="slider" data-question="4">
                    </div>
                </div>
            </div>

            <div class="question">
                <div class="question-text">5. ç§ã¯ã€ã—ã£ã‹ã‚Šç‰©äº‹ã‚’ã“ãªã—ã€ãƒ†ã‚­ãƒ‘ã‚­è¡Œå‹•ã—ã€é©åˆ‡ã«ç‰©äº‹ã‚’è¡ŒãŠã†ã¨ã™ã‚‹ã€‚</div>
                <div class="slider-container">
                    <div class="slider-labels">
                        <span>ã‹ãªã‚Šå½“ã¦ã¯ã¾ã‚‹</span>
                        <span>å½“ã¦ã¯ã¾ã‚‹</span>
                        <span>ã©ã¡ã‚‰ã§ã‚‚ãªã„</span>
                        <span>å½“ã¦ã¯ã¾ã‚‰ãªã„</span>
                        <span>ã‹ãªã‚Šå½“ã¦ã¯ã¾ã‚‰ãªã„</span>
                    </div>
                    <div class="slider-wrapper">
                        <input type="range" dir="rtl" name="q5" min="0" max="4" value="2" step="1" class="slider" data-question="5">
                    </div>
                </div>
            </div>

            <div class="question">
                <div class="question-text">6. ç§ã¯ã€ç‰©é™ã‹ã§ã€äººãŒå¤šã„ãƒ‘ãƒ¼ãƒ†ã‚£ãªã©ã¯è‹¦æ‰‹ã ã€‚</div>
                <div class="slider-container">
                    <div class="slider-labels">
                        <span>ã‹ãªã‚Šå½“ã¦ã¯ã¾ã‚‹</span>
                        <span>å½“ã¦ã¯ã¾ã‚‹</span>
                        <span>ã©ã¡ã‚‰ã§ã‚‚ãªã„</span>
                        <span>å½“ã¦ã¯ã¾ã‚‰ãªã„</span>
                        <span>ã‹ãªã‚Šå½“ã¦ã¯ã¾ã‚‰ãªã„</span>
                    </div>
                    <div class="slider-wrapper">
                        <input type="range" dir="rtl" name="q6" min="0" max="4" value="2" step="1" class="slider" data-question="6">
                    </div>
                </div>
            </div>

            <div class="question">
                <div class="question-text">7. ç§ã¯ã€å¤šãã®å ´åˆãƒªãƒ©ãƒƒã‚¯ã‚¹ã—ã¦ã„ã¦ã€è½ã¡ç€ããŒã‚ã‚Šã€ã‚ã£ãŸã«å•é¡Œã«ã¤ã„ã¦æ‚©ã¾ãªã„ã€‚</div>
                <div class="slider-container">
                    <div class="slider-labels">
                        <span>ã‹ãªã‚Šå½“ã¦ã¯ã¾ã‚‹</span>
                        <span>å½“ã¦ã¯ã¾ã‚‹</span>
                        <span>ã©ã¡ã‚‰ã§ã‚‚ãªã„</span>
                        <span>å½“ã¦ã¯ã¾ã‚‰ãªã„</span>
                        <span>ã‹ãªã‚Šå½“ã¦ã¯ã¾ã‚‰ãªã„</span>
                    </div>
                    <div class="slider-wrapper">
                        <input type="range" dir="rtl" name="q7" min="0" max="4" value="2" step="1" class="slider" data-question="7">
                    </div>
                </div>
            </div>

            <div class="question">
                <div class="question-text">8. ç§ã¯ã€å¤šãã®ã“ã¨ã‚’ç¾å®Ÿçš„ã«è€ƒãˆã€ä¼çµ±çš„ãªè€ƒãˆæ–¹ã‚’å¥½ã¿ã€ã‚ã£ãŸã«ç©ºæƒ³ã§æ™‚é–“ã‚’æµªè²»ã—ãªã„ã€‚</div>
                <div class="slider-container">
                    <div class="slider-labels">
                        <span>ã‹ãªã‚Šå½“ã¦ã¯ã¾ã‚‹</span>
                        <span>å½“ã¦ã¯ã¾ã‚‹</span>
                        <span>ã©ã¡ã‚‰ã§ã‚‚ãªã„</span>
                        <span>å½“ã¦ã¯ã¾ã‚‰ãªã„</span>
                        <span>ã‹ãªã‚Šå½“ã¦ã¯ã¾ã‚‰ãªã„</span>
                    </div>
                    <div class="slider-wrapper">
                        <input type="range" dir="rtl" name="q8" min="0" max="4" value="2" step="1" class="slider" data-question="8">
                    </div>
                </div>
            </div>

            <div class="question">
                <div class="question-text">9. ç§ã¯ã€æ€ã£ãŸã“ã¨ã‚’ã™ãå£ã«ã—ã€å†·æ·¡ãªã¨ããŒã‚ã‚Šã€ç›¸æ‰‹ã«åŒæƒ…ã‚’æ„Ÿã˜ã‚‹ã“ã¨ã¯ã‚ã£ãŸã«ãªã„ã€‚</div>
                <div class="slider-container">
                    <div class="slider-labels">
                        <span>ã‹ãªã‚Šå½“ã¦ã¯ã¾ã‚‹</span>
                        <span>å½“ã¦ã¯ã¾ã‚‹</span>
                        <span>ã©ã¡ã‚‰ã§ã‚‚ãªã„</span>
                        <span>å½“ã¦ã¯ã¾ã‚‰ãªã„</span>
                        <span>ã‹ãªã‚Šå½“ã¦ã¯ã¾ã‚‰ãªã„</span>
                    </div>
                    <div class="slider-wrapper">
                        <input type="range" dir="rtl" name="q9" min="0" max="4" value="2" step="1" class="slider" data-question="9">
                    </div>
                </div>
            </div>

            <div class="question">
                <div class="question-text">10. ç§ã¯ã€æ·±ãè€ƒãˆãšã«è¡Œå‹•ã—ã€ã‚ã¾ã‚Šãã¡ã‚“ã¨è¡Œå‹•ã›ãšã€ã‚®ãƒªã‚®ãƒªã¾ã§ç‰©äº‹ã«æ‰‹ã‚’ã¤ã‘ãªã„ã€‚</div>
                <div class="slider-container">
                    <div class="slider-labels">
                        <span>ã‹ãªã‚Šå½“ã¦ã¯ã¾ã‚‹</span>
                        <span>å½“ã¦ã¯ã¾ã‚‹</span>
                        <span>ã©ã¡ã‚‰ã§ã‚‚ãªã„</span>
                        <span>å½“ã¦ã¯ã¾ã‚‰ãªã„</span>
                        <span>ã‹ãªã‚Šå½“ã¦ã¯ã¾ã‚‰ãªã„</span>
                    </div>
                    <div class="slider-wrapper">
                        <input type="range" dir="rtl" name="q10" min="0" max="4" value="2" step="1" class="slider" data-question="10">
                    </div>
                </div>
            </div>

            <div class="result-box" id="resultBox">
                <h3>è¨ºæ–­çµæœ</h3>
                <div id="resultContent"></div>
            </div>

            <div class="button-group">
                <button type="submit" class="submit-button" id="submitButton">è¨ºæ–­çµæœã‚’è¡¨ç¤º</button>
                
            </div>
        </form>
    </div>

    <script>
        // 8ã¤ã®ã‚¿ã‚¤ãƒ—å®šç¾©
        const personalityTypes = {
            'å‰µé€ å‹-æ¥½è¦³å‹-å¤–å‘å‹': {
                name: 'ç™ºæƒ³ã§å°ããƒ“ã‚¸ãƒ§ãƒŠãƒªãƒ¼',
                description: 'ç«ã‚’ã¤ã‘ã¦èµ°ã‚‹äººãƒ»å…ƒæ°—ã‚’é‹ã¶äºº'
            },
            'å®Ÿè¡Œå‹-æ¥½è¦³å‹-å¤–å‘å‹': {
                name: 'ä¿¡é ¼ã§ã¾ã¨ã‚ã‚‹ã‚³ãƒ³ãƒ€ã‚¯ã‚¿ãƒ¼',
                description: 'å®‰å¿ƒã‚’å±Šã‘ã‚‹äººãƒ»ãƒãƒ¼ãƒ ã‚’å‹•ã‹ã™å®Ÿè¡Œå±‹'
            },
            'å‰µé€ å‹-æ¥½è¦³å‹-å†…å‘å‹': {
                name: 'æ–°ã—ã„ç¨®ã‚’ã¾ããƒ—ãƒ©ãƒ³ãƒŠãƒ¼',
                description: 'ç™ºæƒ³ã‚’å±Šã‘ã‚‹äººãƒ»é™ã‹ã«åºƒã’ã‚‹ç€æƒ³åŠ›'
            },
            'å®Ÿè¡Œå‹-æ¥½è¦³å‹-å†…å‘å‹': {
                name: 'ç€å®Ÿãªé“ã‚’ç¯‰ãã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒˆ',
                description: 'ç¾åœ¨ã¨æœªæ¥ã‚’å®ˆã‚‹äººãƒ»ä¸å¯§ã«ã€ç¢ºå®Ÿã«'
            },
            'å‰µé€ å‹-å•é¡Œå¿—å‘å‹-å¤–å‘å‹': {
                name: 'è¦‹ãˆãªã„èª²é¡Œã‚’ç…§ã‚‰ã™ãƒ•ã‚¡ã‚·ãƒªãƒ†ãƒ¼ã‚¿ãƒ¼',
                description: 'æŒ‘æˆ¦ã‚’å°ãäººãƒ»å±æ©Ÿã‚’ãƒãƒ£ãƒ³ã‚¹ã«å¤‰ãˆã‚‹'
            },
            'å®Ÿè¡Œå‹-å•é¡Œå¿—å‘å‹-å¤–å‘å‹': {
                name: 'ãƒãƒ¼ãƒ ã‚’å®ˆã‚‹ãƒ¡ãƒ‡ã‚£ã‚¨ãƒ¼ã‚¿ãƒ¼',
                description: 'é™°ã§æ”¯ãˆã‚‹äººãƒ»å®‰å®šã‚’æ”¯ãˆã‚‹å®Ÿè¡ŒåŠ›'
            },
            'å‰µé€ å‹-å•é¡Œå¿—å‘å‹-å†…å‘å‹': {
                name: 'è§£ã®åœ°å›³ã‚’æãã‚¹ãƒˆãƒ©ãƒ†ã‚¸ã‚¹ãƒˆ',
                description: 'åˆ†æã§å°ãäººãƒ»é™ã‹ãªæˆ¦ç•¥å®¶'
            },
            'å®Ÿè¡Œå‹-å•é¡Œå¿—å‘å‹-å†…å‘å‹': {
                name: 'ç²¾åº¦ã‚’ç£¨ãã‚¬ãƒ¼ãƒ‡ã‚£ã‚¢ãƒ³',
                description: 'ç·»å¯†ã•ã§æ”¯ãˆã‚‹äººãƒ»å®Œæˆåº¦ã®è·äºº'
            }
        };

        // ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡å‡¦ç†
        document.getElementById('diagnosisForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const formData = new FormData(this);
            
            // ã‚¹ã‚³ã‚¢è¨ˆç®—ï¼ˆé€†è»¢é …ç›®ã‚’è€ƒæ…®ï¼‰
            const extraversion = parseInt(formData.get('q1')) + (4 - parseInt(formData.get('q6')));
            const neuroticism = parseInt(formData.get('q2')) + (4 - parseInt(formData.get('q7')));
            const openness = parseInt(formData.get('q3')) + (4 - parseInt(formData.get('q8')));
            const agreeableness = parseInt(formData.get('q4')) + (4 - parseInt(formData.get('q9')));
            const conscientiousness = parseInt(formData.get('q5')) + (4 - parseInt(formData.get('q10')));
            
            // ãƒ‡ãƒãƒƒã‚°ç”¨ãƒ­ã‚°
            console.log('=== ãƒ“ãƒƒã‚°ãƒ•ã‚¡ã‚¤ãƒ–è¨ºæ–­ ãƒ‡ãƒãƒƒã‚°æƒ…å ± ===');
            console.log('Q1ï¼ˆå¤–å‘æ€§ï¼‰:', formData.get('q1'), 'ç‚¹');
            console.log('Q6ï¼ˆå¤–å‘æ€§ãƒ»é€†ï¼‰:', formData.get('q6'), 'ç‚¹ â†’ å¤‰æ›å¾Œ:', (4 - parseInt(formData.get('q6'))), 'ç‚¹');
            console.log('å¤–å‘æ€§ã‚¹ã‚³ã‚¢:', extraversion, 'ç‚¹');
            console.log('');
            console.log('Q2ï¼ˆç¥çµŒç—‡å‚¾å‘ï¼‰:', formData.get('q2'), 'ç‚¹');
            console.log('Q7ï¼ˆç¥çµŒç—‡å‚¾å‘ãƒ»é€†ï¼‰:', formData.get('q7'), 'ç‚¹ â†’ å¤‰æ›å¾Œ:', (4 - parseInt(formData.get('q7'))), 'ç‚¹');
            console.log('ç¥çµŒç—‡å‚¾å‘ã‚¹ã‚³ã‚¢:', neuroticism, 'ç‚¹');
            console.log('');
            console.log('Q3ï¼ˆé–‹æ”¾æ€§ï¼‰:', formData.get('q3'), 'ç‚¹');
            console.log('Q8ï¼ˆé–‹æ”¾æ€§ãƒ»é€†ï¼‰:', formData.get('q8'), 'ç‚¹ â†’ å¤‰æ›å¾Œ:', (4 - parseInt(formData.get('q8'))), 'ç‚¹');
            console.log('é–‹æ”¾æ€§ã‚¹ã‚³ã‚¢:', openness, 'ç‚¹');
            console.log('');
            console.log('Q4ï¼ˆå”èª¿æ€§ï¼‰:', formData.get('q4'), 'ç‚¹');
            console.log('Q9ï¼ˆå”èª¿æ€§ãƒ»é€†ï¼‰:', formData.get('q9'), 'ç‚¹ â†’ å¤‰æ›å¾Œ:', (4 - parseInt(formData.get('q9'))), 'ç‚¹');
            console.log('å”èª¿æ€§ã‚¹ã‚³ã‚¢:', agreeableness, 'ç‚¹');
            console.log('');
            console.log('Q5ï¼ˆèª å®Ÿæ€§ï¼‰:', formData.get('q5'), 'ç‚¹');
            console.log('Q10ï¼ˆèª å®Ÿæ€§ãƒ»é€†ï¼‰:', formData.get('q10'), 'ç‚¹ â†’ å¤‰æ›å¾Œ:', (4 - parseInt(formData.get('q10'))), 'ç‚¹');
            console.log('èª å®Ÿæ€§ã‚¹ã‚³ã‚¢:', conscientiousness, 'ç‚¹');
            console.log('=====================================');
            
            // ã‚¿ã‚¤ãƒ—åˆ¤å®šï¼ˆPDFã®åŸºæº–é€šã‚Šï¼š5ç‚¹ä»¥ä¸Š=è©²å½“ã€4ç‚¹ä»¥ä¸‹=éè©²å½“ï¼‰
            const extraversionType = extraversion >= 5 ? 'å¤–å‘å‹' : 'å†…å‘å‹';
            const neuroticismType = neuroticism >= 5 ? 'å•é¡Œå¿—å‘å‹' : 'æ¥½è¦³å‹';
            const opennessType = openness >= 5 ? 'å‰µé€ å‹' : 'å®Ÿè¡Œå‹';
            
            const typeKey = `${opennessType}-${neuroticismType}-${extraversionType}`;
            const personalityType = personalityTypes[typeKey];
            
            // ãƒ‡ãƒ¼ã‚¿æº–å‚™
            const data = {
                test_type: '4_bigfive',
                date: new Date().toLocaleDateString('ja-JP'),
                time: new Date().toLocaleTimeString('ja-JP'),
                timestamp: new Date().toLocaleString('ja-JP')
            };
            
            // å„è³ªå•ã®å›ç­”ã‚’å–å¾—
            for (let i = 1; i <= 10; i++) {
                data[`q${i}`] = formData.get(`q${i}`);
            }
            
            data.extraversion = extraversion;
            data.neuroticism = neuroticism;
            data.openness = openness;
            data.agreeableness = agreeableness;
            data.conscientiousness = conscientiousness;
            data.personality_type = `${personalityType.name}ï¼ˆ${personalityType.description}ï¼‰`;
            
            // ã‚¿ã‚¤ãƒ—ç•ªå·ã‚’å–å¾—ï¼ˆ1-8ï¼‰
            const typeNumber = {
                'å‰µé€ å‹-æ¥½è¦³å‹-å¤–å‘å‹': '1',
                'å®Ÿè¡Œå‹-æ¥½è¦³å‹-å¤–å‘å‹': '2',
                'å‰µé€ å‹-æ¥½è¦³å‹-å†…å‘å‹': '3',
                'å®Ÿè¡Œå‹-æ¥½è¦³å‹-å†…å‘å‹': '4',
                'å‰µé€ å‹-å•é¡Œå¿—å‘å‹-å¤–å‘å‹': '5',
                'å®Ÿè¡Œå‹-å•é¡Œå¿—å‘å‹-å¤–å‘å‹': '6',
                'å‰µé€ å‹-å•é¡Œå¿—å‘å‹-å†…å‘å‹': '7',
                'å®Ÿè¡Œå‹-å•é¡Œå¿—å‘å‹-å†…å‘å‹': '8'
            }[typeKey];
            
            // çµæœã‚’è¡¨ç¤º
            document.getElementById('resultContent').innerHTML = `
                <div class="result-item">
                    <strong>å„ç‰¹æ€§ã®ã‚¹ã‚³ã‚¢</strong><br>
                    å¤–å‘æ€§ï¼š${extraversion}ç‚¹ï¼ˆ${extraversionType}ï¼‰<br>
                    ç¥çµŒç—‡å‚¾å‘ï¼š${neuroticism}ç‚¹ï¼ˆ${neuroticismType}ï¼‰<br>
                    é–‹æ”¾æ€§ï¼š${openness}ç‚¹ï¼ˆ${opennessType}ï¼‰<br>
                    å”èª¿æ€§ï¼š${agreeableness}ç‚¹<br>
                    èª å®Ÿæ€§ï¼š${conscientiousness}ç‚¹
                </div>
                <div class="result-item">
                    <strong>ã‚ãªãŸã®ãƒ‘ãƒ¼ã‚½ãƒŠãƒªãƒ†ã‚£ã‚¿ã‚¤ãƒ—</strong><br>
                    <span style="font-size: 18px; color: #000000;">${personalityType.name}</span><br>
                    ${personalityType.description}
                </div>
                <div class="result-item" style="text-align: center; margin-top: 20px;">
                    <a href="4_bigfive-result.html?type=${typeNumber}" 
                       style="display: inline-block; background-color: #ffff00; color: #000000; 
                              padding: 15px 30px; text-decoration: none; font-weight: bold; 
                              border: 2px solid #000000; font-size: 16px; transition: all 0.3s;"
                       onmouseover="this.style.backgroundColor='#000000'; this.style.color='#ffff00';"
                       onmouseout="this.style.backgroundColor='#ffff00'; this.style.color='#000000';">
                        ğŸ“– è©³ç´°çµæœã‚’è¦‹ã‚‹ï¼ˆå‘ã„ã¦ã„ã‚‹è·ç¨®ãƒ»ã‚¹ãƒˆãƒ¬ã‚¹å¯¾ç­–ãªã©ï¼‰
                    </a>
                </div>
            `;
            
            document.getElementById('resultBox').classList.add('show');
            document.getElementById('pdfButton').classList.add('show');
            document.getElementById('submitButton').classList.add('hide');
            
            // ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã«é€ä¿¡
            const scriptURL = 'https://script.google.com/macros/s/1tUO1DPTCTPJ9-LfXSNDFXGIjk8vg6SI3MtU6j6WxKfs/exec';
            
            fetch(scriptURL, {
                method: 'POST',
                body: JSON.stringify(data),
                headers: {
                    'Content-Type': 'application/json'
                }
            })
            .then(response => response.json())
            .then(result => {
                console.log('ãƒ‡ãƒ¼ã‚¿é€ä¿¡æˆåŠŸ:', result);
            })
            .catch(error => {
                console.error('Error:', error);
            });
            
            // çµæœã¾ã§è‡ªå‹•ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«
            document.getElementById('resultBox').scrollIntoView({ behavior: 'smooth' });
        });
    </script>
</body>
</html>
